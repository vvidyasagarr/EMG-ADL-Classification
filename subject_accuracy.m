function [y1] = subject_accuracy(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 22-Nov-2022 23:40:05.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx64 matrix, input #1
% and returns:
%   y = Qx6 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 6 7 8 9 14 15 16 17 22 23 24 25 30 31 32 33 38 39 40 41 46 47 48 49 54 55 56 57 62 63 64];
x1_step2.xoffset = [46.142678;0.155381673361038;0.0322491982268484;0.407030999756587;19.7913097778597;0.240331765539652;0.0128853940661603;0.300452723291878;12.0020202931022;0.594282863339132;0.0152234916874643;0.342418642828735;6.56148588763352;0.993567273771605;0.0412287452795994;0.297675743023799;46.350319;0.0178474334400028;0.0295819811581609;0.387262238161641;21.3956017243867;0.00587632939175145;0.115523958147309;0.295611598099665;9.57826903507353;0.135036607285262;0.129165540060356;0.363335807798603;6.68881200698618;0.441917254205313;0.0650279764162889;0.289316317413262];
x1_step2.gain = [0.0160958217749573;1.09000580267698;0.689358165670678;1.09729749703934;0.0133126322497323;1.04270159300522;0.493043374661269;1.48421065640402;0.0220315545160894;0.999113985783162;0.561572777463447;1.84655849494705;0.0299465685015482;0.921158278628744;0.644544396337628;2.24224811498562;0.00720855800005767;1.04145252663245;0.582697957937943;1.93280739440303;0.00706938639752348;0.936561723783734;0.640593834311707;3.06659512964738;0.0105770925854612;0.750838238774514;0.572816882116052;3.39637225868039;0.0146390940279743;0.759648492885586;0.541444871542115;3.30189993061808];
x1_step2.ymin = -1;

% Layer 1
b1 = [-1.3387756458678177207;-1.3479152358376274012;-1.3970643319280640071;-1.3089664364910762462;-1.3035039285228831041;-0.61863472518848672266;-0.93606470459324409017;-0.65137444589016746388;-0.94093971771916262714;0.3447498059951549787;-0.38909502356793790323;0.97561685207821335908;-0.34095826284029068232;-0.20201120250349477447;0.49707240337502339722;-0.43683225426677657621;-0.51459568372109354417;0.16001425068001898233;0.34006143486593032321;-0.25394606778582118345;-0.59336747444598614276;0.54241592054527254518;0.8497735487072958227;0.80816305330436033483;-0.9657901480409579742;-0.9132042650289202701;0.69254428250496935515;-0.72465414961892049561;1.1261213448006968108;1.1931043698153853683;-1.4467601737381459159;1.4138671889635514578];
IW1_1 = [0.6187537074064001219 -0.39389886482156255543 -0.13977120556451033684 0.011801511684747752196 0.39881054552314110229 -0.465734727668409898 -0.29978975899670118332 -0.24414381080764391285 0.31642640082264406054 -0.012012755647730549713 -0.12894448417042969623 -0.49441092870655140024 -0.29107815561547401018 0.17346441448469682167 0.26440035967252789595 -0.1990293052983561628 -0.52781624532642412717 0.53084063071857001681 -0.29400369201710013778 -0.49676573217822578288 -0.49947786904673036057 -0.20042998393325217599 -0.38343971022142459004 0.23723152967755947729 -0.58999792750456991897 0.51761306889494185235 -0.17771124168811694433 0.15786810409161405877 0.088815022354505834823 0.046251256625209860585 0.20692805408701964165 0.27567701490110441132;0.17146378139411658226 -0.22729553995361351237 0.31638903959050246328 -0.19274950506129148731 -0.31165194879673835393 0.16154755641848678183 -0.027812384219505763283 -0.13532955214776767883 -0.29957233095310253912 0.55287992863513435449 0.1611003309723180732 0.15394841652757010331 -0.42258207119692076104 0.3962672457634564549 0.38809258691470843727 -0.01569091985830253777 -0.0042230138988238472356 -0.63943456616108851343 -0.17317532829984769172 0.41684093257844734293 -0.09741828497048764246 -0.12343080538272892255 -0.41739440651948567229 0.077711755409352323287 -0.31834989422483511712 0.13512885231287066756 -0.10314045551930640932 -0.1559137107244759346 -0.47068747138623628912 -0.21727948580453207428 0.38769666363813393151 0.20402943022134348294;0.88550952566998042403 0.30597065732796563386 0.12002786418143589209 0.17299945200840713411 0.069637040084951126739 -0.36489661625412173063 0.19793628656268436039 -0.20113732678407769683 0.36473325312006515952 -0.05827852359178851277 -0.35566626957807606635 0.06077533921487943136 0.07137899042113236836 -0.31372227856394024892 0.081798870163249423615 -0.55021493010868482987 -0.30252467962795598355 1.1464273589868683167 0.011615251671517997506 -0.12828312902071989376 -0.52244898654085214496 0.94528102704968897108 0.070573699111641297055 -0.03543802321965777713 0.088059760152694024904 0.64494380635776471511 -0.32258734691566331998 0.096205971732402500995 -0.69132607349659935814 0.1652574233896042244 -0.28755118964600723253 0.11813245317501501475;0.4722560022332935592 -0.49527485358750666933 -0.33505761094642083631 -0.53789708505666489202 -0.16224135938604045126 -0.068927561959556932214 -0.046529404866074014491 -0.43995285455551635945 0.25668540019606272962 -0.13277288383656837834 0.20164938670891760508 0.018301789765050861802 -0.31686699114851368808 0.4586465593519247208 0.019981668446600819866 -0.32942314071617723181 0.60056244037781136846 -0.36544126411042321401 0.026137492925655883558 -0.6684007960723280517 -0.045171768830855926757 -0.59987119039171155066 0.059041415016258404214 -0.92676222788450035583 -0.47896835547371896524 -0.0085058620380028364394 0.062846904058215691258 0.28960041796241625667 -0.21527160915578336109 -0.019598122296067339854 0.16226447077457467616 0.47194840043125713125;0.38358970354958554783 0.042617152072168040799 -0.10041311682635130353 0.21281067434953340745 0.076412188138683612149 -0.072225016228513586047 0.40530684166313241112 -0.21985098712094311435 -0.23922257324635090581 0.033679545787867991302 -0.0052574657176119397178 0.15348936414146796547 -0.24289992009230931824 -0.33982553973877971387 -0.50565738253628023102 -0.28909910604549093893 -0.20516092876071170825 -0.33649886754132801725 -0.13276652468910091209 -0.070806843870836813637 0.2677069922029194915 -0.11584725525931741097 -0.46841678724776814047 -0.017032758547818552947 0.096732195475592377965 0.34428687596885676481 0.48069153664160024775 -0.24300061861242336358 0.5708624480566031334 -0.40008235951721915491 -0.26103706687721767166 -0.062357709814221215505;0.33445441789303798075 -0.0770880719702368572 -0.20619341700479046353 -0.6822015376312519086 0.20105807010178647354 -0.2664346531344781166 -0.35201554355184017098 -0.4801619539079770016 0.17616324997622415105 -0.47375827919965851631 0.34181637438819512109 -0.66633396360445906748 0.21659982529748952884 -0.27511828641158936337 0.30934295297865738172 -0.11604135535120088663 0.21472639525645295655 -0.92190226180718304327 -0.58367637311235143205 0.4816460154701837082 0.22795520561920729063 -0.018908071809415925163 -0.079639480755619482255 -0.26159914797914263218 0.21849611275605948513 -0.42679200349466983599 -0.42065406819374939751 -0.17488094990411875984 -0.21462859072958567763 -0.22510494680786527488 0.16979127352371298221 -0.18631965656975219003;0.33368615816882712943 0.5185754526729144942 -0.18535597741829099028 -0.38410563187284219033 0.062167932919935074698 -0.018195583176298033012 0.25440303436333389087 -0.056980834013557773998 0.38965659020531362433 0.53169758008604828259 -0.07762337931879355335 0.021024255071934495193 -0.015417954212481668752 0.25957637183102094669 0.044219728368832283971 0.0067737616928946753347 -0.30335672336595947973 0.2681406403450318221 0.11342714022374626726 -0.39782295049863658498 0.2072772337413510968 -0.10840047737669041006 -0.42788942282462760769 -0.318243049386882082 -0.040545422729160472686 0.18911559207917358338 0.274721003564572408 0.32431020152264444789 -0.39067872926059643568 0.41622686720267787486 0.28385393944714015779 -0.071263214755583892401;-0.15699908042306953693 0.38073967244385609199 -0.29832416782035098279 -0.25795988884566328769 0.26126559364834178734 0.37506091923727469251 -0.19357975082684081292 -0.039427740446623518733 -0.18461082742468581941 0.049276443907850055182 0.21440247682586752176 -0.1448781710949627044 0.23012519540265097273 -0.45976952339061405439 -0.026124054801448425706 -0.42202452485111896507 -0.3312655322766495658 -0.54486626631220635986 -0.11669379183565690983 0.028569234468178515696 -0.45103699190761109561 -0.029396917965871682821 -0.24445083359742786344 -0.11363275406985472171 -0.55064777428044064944 -0.19391817044819331661 -0.32453834122174746168 0.16639430119325296364 -0.30791136349520836779 0.19233448330837879525 -0.34948661180975892915 -0.38703198996254728481;0.038604384552928111551 0.33505940098243036651 -0.12650382215254876717 1.3547635215918076845 -0.062251760224030394664 0.86391546761562787449 -0.11495561894659560298 0.57380355630503765418 -0.12810028046695343118 -0.16827868090131353762 -0.16043680617828046109 -0.21954170019985635998 0.11151753360423241612 0.46100150947589246808 0.070230881522587620958 0.15391181562091399426 -0.83632592437875541425 0.39129786171277908258 -0.33718721074609597776 -0.20247647784373792867 -0.59026217064560992931 0.53715889252500692574 0.048613943249643111477 0.022144478983596848493 -0.035980551118982607994 0.28172990119052260249 -0.24455189498376533885 -0.67536024791841109405 -0.29992250029287481627 0.19201335528660956609 -0.68121629863717969577 -0.76155352834313894128;-0.53169421693562157749 0.67658688006751610544 -0.28316924872345555775 -0.025050624681476611755 -0.42992176681920407644 0.56882075972554357879 0.039433730255118350227 0.27079202222947096335 -0.36924677237744607528 0.11981717076973229241 0.12648630228099072559 0.41467217291272995272 0.2134630132401652558 0.60912661745728835516 0.37407120805553872867 0.5201498728836807528 0.18418903221785182245 -0.098670220266783653651 0.22501735582224055565 0.24771245625706717064 0.15080968326956825654 -0.2088871803581936748 -0.34887370347982499252 -0.388810319279955241 -0.21211168709915487196 0.31783490926231339202 -0.0069330421617283411601 0.0096038230219714863095 -0.44031296909213796242 0.32214794704954369253 0.40721715543184622277 -0.24781480637864530814;0.57366376170687916058 -0.21275673855938337375 -0.15843317037614451648 0.030869491678888850289 0.35879563240074746622 -0.66118223078917792712 0.48891587790588891815 -0.42643375662623733691 0.40689936244738889037 0.27410567006721137107 -0.57451181330908684952 0.023293005198930363808 -0.13185874235429284607 -0.23718551606284846156 -0.0089201962196004732503 -0.41078202620071302409 -0.17192492655230265375 -0.15163585414926936124 0.39886792451421626549 -0.23078459819844079903 0.2680913662444345813 -0.6640371757032713651 0.07663950527714394334 0.12592319168460866519 -0.34126264476452278229 0.25125620919148644594 -0.48741134966747906576 0.33651227223033736147 -0.20167258154896955391 -0.22788573522996510845 -0.55742598622636796435 0.19770686705582457554;-0.10601983108808542278 0.0016019192571639718006 -0.1479751235630603623 -0.10362233961491069956 0.11828485319779816209 0.17558846772764552524 0.13115027307451149197 0.23343656483644142918 0.29633114943954980136 -0.19264359293302943388 0.096473373203111542629 -0.53348035375056468421 -0.43813779654415724307 -0.58563502789080756905 -0.031148285236987399704 0.47561925638912511127 0.20524749648524720502 -0.71430834568912371374 -0.60907206106071665186 0.98006584698938503664 0.34849231062002783421 -0.53221480940968435291 -0.48333360541740699734 0.73063698275935584636 -0.24927726910671443861 -0.81808003529015538291 0.16846967559745504306 0.10684846073006881717 -0.039607206513304682449 -0.97598874275208613582 0.21936596769373387095 0.13644962570593754947;0.012284139658879580578 0.10892468991593166894 -0.19390890691952758496 0.15931469710060999767 0.33772155366636585905 -0.25517155382633099903 0.33627081390318075416 -0.15741167065405603509 0.15576970959626396107 0.28843680154216916334 -0.23861853280977493585 -0.056125928491401619325 0.074886906276764350632 0.15610306973128892927 0.38826586836204346476 0.2020017834267904544 0.11126659326989848942 -0.61709472339829585241 -0.40658530334921860749 -0.15111981956228182078 0.060604356012922161456 0.042404013656279035405 0.22094489133485048504 -0.35490664780929376265 0.089987410538493503576 0.071940414495458487876 0.098910159156356675103 0.3249811407678491193 0.43941027081650063657 0.1048748014707961973 0.04843294848614317083 -0.29920255328358108526;0.64950806590181864308 -0.31680592233915705336 0.035781451131125900644 0.28427908695388337534 0.017999980380244237632 0.11743633668147734905 0.14464345312803306154 0.032808391275996814929 -0.086173958422160773507 -0.52439371326694939057 0.14851226106084383649 -0.18411997372688157504 -0.29720092198697728447 0.34761803521920675575 -0.42399620193653914102 -0.20955804430338870192 -0.77036608108638604531 0.1134751255374072676 -0.41826090352317357723 0.67079000197954508078 -0.64055765336482106687 0.78879148323722381164 0.054895348365656196354 0.52634773059203554535 -0.033036643411993762975 0.27848431971055875866 0.32102933945259881643 0.22307782092225372783 -0.013663796818137688427 -0.17778437337861760503 -0.21968088317612302629 -0.58622257628849316902;-0.21488295947184354873 -0.32851705153493276912 -0.08964647482984362814 -0.72983844456883306684 0.55416872862887101014 -0.8546058068273684194 -0.084262127420027851943 -0.20905325855453177342 -0.13396950046046551819 -0.46722480806726024438 0.059364040260213746247 -0.17230914520856183136 -0.12937012699397237858 -0.22918441720342969115 -0.22380467704471196377 0.12632066134393488133 0.45853936882213447435 -0.69033406588428480877 -0.37906955185764745764 0.059742513658306080349 0.35930882016233811616 -0.68391555143863924648 -0.0092066077352001337436 0.034187307030030714139 -0.46250196494584655538 -0.44108808296646945246 0.14737399266675987874 -0.05359597012355642176 0.24459211119702828352 -0.17667564922102282909 -0.060900837802023911893 -0.28080893748984570024;-0.13017242853985111495 0.7796800099836301845 -0.29266881841924829999 0.34975451908604487938 0.12035914408628081707 0.27349234028018598597 0.43091329171824210853 0.46847740690745559577 -0.25772484060090522506 0.4049095286067602717 -0.2711153937198059749 0.2524316640368431397 -0.2678324490475448294 -0.14008190239904641516 0.017121980523010400799 -0.17274341185989242065 -0.20272438824081148723 1.0439999121242486968 0.11889842276766572626 0.28831517251081861808 -0.010850137070418758647 0.62413953682951139879 0.14142839438971427368 0.25606194823754657719 -0.29627722772066950041 0.38475449752291923655 -0.19331366798079999136 -0.3848865016340730083 -0.40414344016540371118 0.61381913997526538207 0.25471109769825811542 -0.46046149675380954047;-0.15310183978629701707 0.25488019829645841563 -0.32501742419936063833 -0.44819171637993610036 -0.046164954790366474757 -0.33349068782009483325 -0.081514747541611892734 0.13784218986835378162 -0.13249601285305021015 0.3181440977393290015 0.33246553968672520885 -0.14740041506893283851 -0.049659647676078937095 0.58458057116630690597 0.26015530638921002815 0.096951504737553623192 0.033048545114690797142 0.37839408017900771908 0.37115191266081937194 -0.53118434234596900723 0.48141398356628495314 0.1576351447887787971 -0.026208074914821601759 -0.074924902742545054779 -0.09801019920302089794 0.82681558852755088207 0.19463968126461841934 -0.097290559331243600671 -0.066713138752125117348 0.78274208389479937864 -0.12180323659825716132 0.45539184510617847224;-0.089040261979807369674 -0.15374820756525206522 0.064057712127654459211 -0.093081549392041551538 0.45241922833327297138 0.0047531360997755296716 -0.24585832584115305255 0.51160294772856418355 -0.076231308951460116652 -0.10917545585544316533 -0.38039887556584989214 0.67435685232677244905 0.42993402077303438658 -0.27064420795159493949 0.13141302116781911069 0.24584715362818562734 0.12808912840899783214 0.14850652305980976964 0.50909818668662709662 -0.09966314554457432473 -0.21632377481449199808 -0.44645968244978351258 -0.12910541737372310811 -0.20335712663866656325 -0.55244441060827764733 0.25353691596514621454 0.22936397676319317251 0.55421720674335051005 -0.70490366404175641701 -0.035047254892595518239 0.34017349421209058802 0.11347325235888208739;0.30618314935475365868 -0.38819175673088290868 -0.040584176330259097432 -0.22078335307481639083 -0.37974109557225865785 -0.30547445750702789669 0.2450322294601358919 0.094211579120295860235 0.42114685684987895886 0.24867161135323603838 -0.3728703716049895367 0.28564027277171621932 0.058717553378547317211 -0.30577378835145940794 -0.25969049999568794007 -0.087916535770178105835 -0.014183071222787462309 0.31363073665023993852 0.58960921439393176868 -0.89333642575152927279 -0.14172812034502482725 0.045276799263532160889 -0.22821557852275831113 -0.084509119358204820571 0.21098142115137716313 0.55806345334698082006 0.33139111255199438233 0.036662026381326269509 -0.30497813533707412992 0.46663417010936675267 0.099742694037992601919 -0.095680959416548083674;-0.12184711027058088562 -0.52662211125645197463 -0.11423432743449180027 -0.45373381010829250126 -0.20720962024324474093 -0.05096820088488203393 -0.12382909266874048138 -0.31789945110614742374 0.18990802453878169453 0.060869766159545805884 0.10261027535944186595 -0.28369376792689171563 -0.25550611433933179129 -0.17149558897211319985 0.29937216895253832005 0.27484706359734678571 0.24223045391735836818 1.1602112438259102323 -0.53003089949299708739 0.29240104187114035472 0.027942033200902615525 0.69053101835868802016 -0.05362962358748753211 0.80348733627120549894 0.23956534851602023783 0.37202811532835927677 -0.10922207442418858936 0.5455042418199060883 -0.13465652540911071666 0.6991338977632390872 0.039322822153720835003 0.37042654231766014572;-0.7561951250180726225 0.5490625387799890067 -0.19790845221958097699 0.12521451241187042669 -0.14107890724714972075 0.60190044713002277543 -0.31395215906323409305 0.17010778323317077287 -0.283547942325519442 -0.14277164639885764341 0.054621804672020046745 0.32833641997732393447 -0.22530190453133616679 -0.076456572371974521052 -0.33665339159715973461 -0.20585973671730664614 -0.43330027503694357183 0.43323541103175072786 -0.41128596361811264881 0.069883572753676126421 -0.28459059955346666104 0.039853587882598101588 0.5374385155933704139 -0.63664336927878606431 -0.15470355231405491514 0.085593564102854832742 -0.11996925022513034442 0.24458382712695586614 -0.30413660887621751794 0.64678995228799085471 -0.0042287361247517231411 0.30937295165425920951;0.56250699544535287533 -0.33001457029302744273 0.077749323727510241677 -0.75682913138002938513 -0.090678663074399826205 0.14638763635021698195 0.22756533265050774006 -0.60504184921406678477 0.22346053744532531904 -0.32568653482542075928 -0.26900125710093281128 0.00727875190233435998 -0.046907384442346961029 -0.19270499512200270353 -0.090860874248920059371 -0.017633169322528580852 0.30120659706612101791 0.3635175881007662313 -0.042475878266158811902 -0.041806659681772766202 0.40362291334712024904 -0.10031716700257493902 0.13112807942383353232 -0.19383817310165279979 -0.34077221701153026512 0.46892285990146781449 0.22347487025778298153 0.63396956780922664176 0.32147629046587605783 0.24026212583244263565 0.44125503368212942723 -0.083722930651151272752;0.18831301387188836838 -0.35824364974272393525 0.010075953485109361007 -0.10637789034865650917 -0.0050011395453615874185 0.138689635662918892 0.085050312234848976511 -0.16936930865927521395 -0.4051092332500144666 -0.380236729466386425 -0.36544119423394177959 -0.54713594490539829707 0.15311126441382588714 -0.11278155498523444178 0.31298101267592204344 -0.056762946233798794449 0.35333509830038084543 -0.20302531246168858958 0.24110862548836711761 0.42360239213997963326 -0.058154185198360179576 0.13631259366022485668 0.24886527537378103081 0.38652538559647126037 0.070537371502128007328 -0.52572984261944399886 0.0120009667683808538 0.15227808319041061247 0.29657162831912031731 -0.034771719349319024639 0.32418800249325485652 0.23221701406077607799;-0.072188814888295149697 0.60818847951889565273 0.47932293332411218811 0.20566382046522438398 -0.34837578548501951792 0.5237830270271430777 0.23652159094609889745 0.20972834168108195341 0.083520129263429832012 -0.16055380041187833351 -0.2037673213596195021 -0.23295914856034771745 -0.51086665431561040229 -0.058694950410261279017 -0.023932513755082398393 -0.2137881472227638191 0.2653372122918634668 0.45220489734473795496 -0.1781862618797822595 0.40423829556412438357 -0.39844580374742993856 0.27901510333835255473 -0.43900082258572636906 0.12783064536851365678 0.46392332689078852326 -0.53957393567898770392 0.034023785426785274622 0.29671695752724541739 0.41780152695863947976 -0.45579381587277556509 -0.35885684648786386752 0.27760025097752355494;-0.22990659513059452657 0.0098002536668639859962 -0.39332994704421664345 0.44505665694159024515 0.44818498297186565305 -0.33982071133811758701 0.40636332627620075364 0.49577806110543282125 -0.032044383255580330405 0.19500963212744507058 -0.15234539189589743624 -0.01741744868486666889 0.28326752343014788282 0.13714196083014282279 0.24517357132289235855 -0.23183288597876824944 -0.0093322594726096257806 0.2411033373269228508 -0.12153373691319936667 -0.4341526982760025577 -0.35801003431686351242 0.090965253030281106872 -0.05375037824195692121 0.052310007426767272942 0.1609985062373983089 -0.45024633761207383253 -0.11745975837174943424 0.15084115896256816702 0.4773333498477195791 -0.25721852429666630657 -0.013822157580796603366 -0.18416506737107482539;-0.50086425848570270691 0.08777784303693114687 0.3824408997292428336 -0.052636802183209291384 -0.27868623798700276062 -0.30425982570771348268 0.052179051352865671309 0.26556015003713245859 0.06141919420548145464 -0.32005880654162705001 -0.1923102626921748548 -0.32017311915288193536 0.38301820466130714893 0.11663806457151928986 -0.016274093890144895186 0.45608432489106531804 0.34129704849398556643 0.40340738987008056826 -0.26644733797608083359 0.18895396089198945866 -0.03012666661486290004 0.24163770953984572976 0.012646079781108758577 0.23137250467435110934 0.11632899909582938847 0.29071738578597244862 -0.39830288000389313385 0.08405254226576353016 0.17214658186948222918 -0.069983614725816059576 -0.58041922597193584821 0.15932960789116895617;0.31348311691439156856 0.45981590219122620011 -0.35653863538769448027 0.33974289768119497746 -0.19613069254288728605 -0.28005850627247758089 -0.28434206501536263278 0.2790967969784139413 0.34610822197038848547 0.0047200391428571823391 -0.24455265608978074554 0.50282791702066698125 -0.37120617584498305508 0.036912875106458062358 -0.29769560922732352104 0.58319896061283682531 0.0056908825374497136115 0.38917189480835356896 0.59844230366366168994 -0.400288492651194594 -0.39981126854656134917 0.66882238403215610312 0.1000230548715220491 -0.32588971931008048344 -0.1071896965050591205 0.8532344180735769168 -0.059230314443095857802 -0.14773115245869591905 -0.098679439724639772535 0.7444153927629616474 0.16999332877529443886 0.31974423212788832815;-0.75489508289719053913 0.52538268049241920732 0.22949748766905342379 -0.12983994199458151475 0.12068953848924021677 0.24840285241336645949 -0.42123412142850102935 0.0085104383395093029935 -0.76067334726258084565 0.25611758825148184249 0.19516067684088353462 -0.034539077933321643554 -0.3235346861473483715 0.40346126313913549533 -0.37148566761915069456 0.28868012383640834218 -0.13272081841562605176 -0.44703180281069909707 -0.66276381824613017635 0.32742949761179718227 0.28221469804806531556 0.15012854417954057951 -0.012681864710781393102 0.39861045971558700662 0.19699759630201862937 -0.38538010424074720106 -0.35397821639534271521 -0.66171385213367672762 0.15818278814316827363 -0.51970150655003621853 0.22781655438887776777 0.45041318298269300557;0.20884179996241492017 0.64136538199335468846 0.42874328166885866676 -0.31897922627333835655 -0.45237638344149633252 0.11033919904833619507 -0.078290984031907276397 0.18077526687326148092 0.26402256229596265946 0.034452432117051137728 0.33855312635310719216 0.11240318697621279331 -0.11639963703490731339 0.57629978882928833972 -0.081222374040766626146 0.26142843773051716028 -0.28607818765125170302 0.56934307440777498499 -0.51634942164263575304 0.076862772863533615486 0.14459242502750921378 0.16833152372973911315 -0.40418898431376837355 -0.10258243595566278461 -0.25860345976818077673 0.0072838340324272712531 -0.24920811197200354314 -0.24310267074394362186 0.13280658132119488313 0.57745203312369108861 0.2366740429351013586 -0.0052338908507528827951;0.63755576447749973124 0.21953657525827263708 0.051562457682492235378 0.15658475098874771736 -0.23971133587967752288 -0.15748262809936697249 0.077910661668099290278 0.073241251588429479025 0.65768167376284070169 -0.004733515201793661413 0.49320865615308545626 -0.078627512525218698491 0.42689657694204080629 0.077260845208245623739 -0.17861254741723134321 -0.13522313690373635731 0.0079283655869108946024 1.2265724947770859643 -0.25553540489393444801 0.85084635954797893653 -0.33921767894044108083 0.63217741313566355732 -0.02280196957696834642 1.0012604103027413771 -0.39214256923116930231 0.41413832843558939789 0.049524456120278601001 -0.36569181641802472882 0.49126207902966767538 0.41203603782559306001 -0.2422740217258455564 -0.28579601741326932096;-0.64538681549996357312 -0.13482942482208215562 -0.055039091150123280183 -0.28829915863800625875 -0.11967072471507203546 0.17232286343836267228 -0.2860442942372496411 -0.46115735946886632357 -0.12225308391372566308 0.0068797790289970191246 0.095179814895339373559 -0.3670717692076455041 -0.55486459112461727905 -0.2429163552778732249 0.07964425807260028245 0.032515878610687318218 -0.30795505773070358524 -0.40073896716403772933 -0.16582079335337729376 -0.4630805902104409566 -0.17081391954705935077 0.38969336810798294035 -0.22949209583315283156 -0.086389415072568948029 -0.0037693483376637490143 -0.26259146762677515463 -0.58869117669866632969 0.58194165518118878833 0.34286528066069366094 -0.15067322534591084948 -0.27829487965357257995 0.065768583025148624754;0.37133078292459587022 -0.26265483070857659209 0.002333296193036269589 0.44941141593969741175 0.17425002209187664959 -0.064752925772035743734 0.090793311990351829865 -0.27099435542316119285 -0.10214056114215903925 0.18133180656302949618 0.33557857436543753193 0.46772645671142243362 -0.29719220661479661683 0.26857307701656951693 0.03367517979909050857 0.25920544536441747496 -0.32734751959758368045 -0.080394139345370416172 0.36502748131571233214 -0.66331611702906390082 0.33867186456902870217 0.38142643822837885015 -0.11686874670915098351 -0.21868936393898769088 -0.33623439519672820852 -0.29219769388441307889 0.26224554787590081961 -0.13504862523010374709 -0.33175550708547985046 -0.13170090415869800671 0.10281364382973171012 -0.36608570379881549828];

% Layer 2
b2 = [-0.47970935739949271959;-0.84197463956717977229;-0.066255635544488516997;0.29550121807846407851;-0.17855245482533571577;-0.12030889881561102062];
LW2_1 = [-1.2760649625063178458 0.33392986039010424948 -1.4351493099180783197 -1.1035270415880222838 -0.30657892625378074802 -0.33259793352695421476 -0.62484381051989457134 -0.18436642553610688156 1.5245728357446768353 0.63134169377773019516 -0.44585467988376120685 1.2452931059594039009 -0.41627485959879406696 0.2583623529803947827 -0.1730538520786841783 0.14910548975437193375 -1.0266677701402509015 -0.46978594452382399504 -1.0159529486952927346 -0.98822822144542865619 0.51705110898905948247 -1.1586272319746975246 -0.11219415284343001171 0.76671128451526449066 0.090585613365844405709 0.13794143148642684649 -0.23520727584758968631 0.74590443989450994078 -0.26435133495272983284 0.3844124898191089712 -0.47445736923273745811 -0.030960774288413588085;-0.8135693924171576441 0.67155702438323339187 -1.1165580878487697536 0.40522266415198004985 -0.060360321279625581137 0.40462606838504777684 -0.47055141306012815416 -0.017593060319011075143 -1.358534801978112716 1.285315030166126693 -0.18693991503033688395 0.34433359208464486834 0.28849416849507636407 -1.1252628616738336031 1.1659092694193384787 -1.1429774522399143155 0.40441035817713189005 0.66739246956323494686 -0.8455518913340047682 0.36663463787283490092 0.5625559852582903142 0.0034687573446113180442 -0.12827482199985126843 0.49929742898843521015 -0.37128182083683525239 -0.84252820446612508576 -0.50302870456348580674 1.2826844738508578203 0.79822714059862831526 -0.9683550765130540805 0.60849794063429896163 -0.68267056724886443497;-0.59795184401841039445 0.41095156846260294525 -0.46845971206873848747 1.0448289791375466873 -0.44582934378212646376 -0.84017628341897887534 0.26645672861504643425 0.11630471271762567176 0.96110162541989274665 0.20620741360759781147 0.53601263049985092835 -1.5868220947719697822 -0.38695325154715648486 -1.1728471653778205219 -0.22036747700970554797 0.48671313441698221824 0.80274700210227245556 0.476472428030652706 0.81186554887377471168 -0.77175379189650428202 0.8918320819840097613 -0.21045121427914773027 -0.7733830186173310528 -0.60444374891045271614 0.95438476395177485045 -0.29371819080631461629 1.2443036626138328504 -0.54485383651233332269 -0.092254053561696913732 -1.2867483317025554257 0.063888807768164343481 0.8755003255369682158;1.208831200368465808 0.047007125311855607608 0.77534791835031935392 0.3910484332411860442 -1.0254385664818348456 0.47781346152113801651 -0.69397419894900014281 -0.19759989179835527051 -0.61413162044027291842 -0.30610331057394091214 1.2764241890276804003 0.35227990499866890239 0.025255846294572985994 0.10244657664242783068 0.58754258848339335763 -0.74662716118774863361 0.45844567658660845266 1.2328177752624860375 0.44218594962861995645 0.63950289442911467663 -0.49683356705123660202 0.42228282808116857083 -0.50194224730703440596 -0.98014651296005317338 0.67954883094479279215 -0.7283302517077154814 -0.032750674102737714621 -0.59607339698057359989 0.5552131069577529443 0.66685804740261589441 -0.55623583960827971406 -0.52089726273547209967;0.035805155320370193883 -0.21754322819141522216 -1.2049750805313221846 -0.0013455348370411367165 0.28813344890289915856 0.9275881733465035639 -0.90829528346768129143 -0.60664344449587792596 -1.1978740628991062511 -0.58921140505656233177 1.2460873542558190685 0.96452200156029777034 -0.23469297339205766328 -0.33463370709508860612 -0.33952295039523072706 -0.98978279386418577257 -0.78972347539075282707 -0.93962300250207020369 0.38075100236875297766 0.53092265889753953445 -1.5313299716123665029 0.74341120592408482803 0.36987772146110864391 0.660997653783445549 -0.15547214179359680752 -0.69348452226963008815 -0.9603709180110510113 -0.19851228206924115272 -0.53970644893712282908 -0.21440162690063585549 -0.01289952535075791426 -0.76124829708354835311;-0.11489674521189321976 -0.13348064540848716963 1.0518975834896473476 -0.79785075205837507895 0.79207218844025495397 -0.40006691021833146182 -0.018805945976053013713 -0.4935784602337963678 0.72141401709610364357 -0.19197818120940321474 -0.64897392039000822983 -0.91935921125184028035 -0.74471125827626072358 0.55628548578665282243 -1.016532003161181974 1.3141467586065467277 0.94759925153800494968 -0.56024529951995727384 0.4120586793206643117 1.3661573627175969126 -0.13819080930083793568 0.19787599689327320385 -0.69919816958876901403 0.66808102034926342139 -0.41000189230972677867 -0.19284454874235804067 0.40315388992968975712 0.18875191137413457887 0.55619839237031865053 1.6624723455539758277 0.043262787910994443541 -0.20143971088080184217];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
y = x(settings.keep,:);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
