function [y1] = subject_64_4(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 29-Nov-2022 00:14:32.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx64 matrix, input #1
% and returns:
%   y = Qx6 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 6 7 8 9 10 11 12 13 14 19 20 21 22 23 24 25 26 27 32 33 34 35 36 37 38 39 40 45 46 47 48 49 50 51 52 53 58 59 60 61 62 63 64];
x1_step2.xoffset = [41.178141;0.279710358134002;0.00528658390094753;0.336539518708952;0.162357526611765;7.907989934247;0.0984244280936454;4.59655918011301;0.123988336652267;18.113897091468;0.406467898178675;0.682756752635634;0.275788752734548;0.0717507931592794;1.54445289569571;0.095808724276499;4.14131396823671;0.117688352816885;8.80368734882737;0.761207687832222;0.384744490683763;0.354392876104263;0.0365692028956952;0.401191980127958;0.0209807427566418;0.210864296070114;0.0265562000186739;3.22633871099039;1.13200976712365;0.152329222317284;0.283961035347258;0.0135796046365131;0.0553216986252025;0.0040199894624177;0.00718288364709833;0.0049013286189663;42.72514;0.00457894899908583;0.00165895886745304;0.377577906947064;0.165741993922401;8.241122564812;0.0670538361204014;2.109393396163];
x1_step2.gain = [0.0154062757787917;1.08459515911055;0.675202205904483;2.23981968213127;3.45872736212499;0.0127680741890605;2.73335825564902;0.0060507223530153;2.13968735148391;0.0145846422050802;1.06287447275283;0.603680960456642;3.94491248600419;3.61346584673589;0.0172813685360259;2.75642649338109;0.00673281444024881;2.25740338816524;0.0216869175919113;0.947301228526988;0.567631791474962;3.84570955176263;5.23924301590616;0.0383934540704943;9.86297072008972;0.0811281536468119;7.63915227793014;0.0323767385820338;0.768551873281557;0.686756159478667;2.77866960039193;7.76037257330183;0.0908032085449295;33.3290161130449;0.980194264003265;25.6897114115242;0.00675361552696731;0.933864953406027;0.784825012049417;1.68659143691117;1.49638000309893;0.00299029083834742;1.31699673614733;0.00153748420616818];
x1_step2.ymin = -1;

% Layer 1
b1 = [1.4666011658411817198;-1.3249925283638348539;-1.0733623029272403304;-0.2995693059255343238;0.37643470824634983618;0.5864792964151407384;-0.4079487160751328334;-0.32673661955513660926;-0.68350753463319735559;-1.7780368240094162058];
IW1_1 = [-0.1626506935215170091 0.26028432426912045949 -0.26799765411574000273 0.047490211661392008058 -0.26787108533888975836 0.32590319011655088932 0.38390787514164775862 0.18982760524185299245 -0.30791261810054770809 0.18926017393945235301 0.28906272084868267491 0.2048611961014882854 0.11414881050685438124 -0.17587246245028431701 0.15508508434097376116 -0.15523685980348000957 0.1157040953482009471 -0.10627173789410464255 -0.10905649780215585787 -0.13140350119183677458 -0.1692626688514139166 -0.17968459523133351041 -0.31132479957517578129 -0.11423512521502390826 -0.01049522800727471783 0.085114827523325900516 0.24205477131420100045 0.030005839530661923553 0.044421939062186728553 -0.18780631789508950291 -0.29551942185642932071 0.22427490012739487169 -0.31396512373556167974 0.31136830422770150895 0.34448808717807893887 0.34963971418896061527 -0.019996633312580665981 0.27978710659147554285 0.35803593549637685589 0.049174541636950834522 0.12591946524401623209 -0.25953744870404255041 -0.062778837808595167047 -0.23293883267625531408;0.013947269290324398189 0.29096574821430232216 0.40721983074624373833 -0.76733341023134726822 -0.20564714725039695553 -0.30735331482004746295 -0.38517383187658144061 0.32200345134924829305 0.14313866983991843651 -0.099793725359517526652 0.33236747398862648284 0.16110686307017960117 -0.17701367094044340167 0.17212370114667782661 -0.23883472338442549021 0.20186325286037407056 0.02310748774919273163 -0.42325155480902831862 0.084543781547429003309 0.042622604338357385212 -0.13265669126509707643 -0.16421167880204087797 -0.36763992031888376166 0.051321228347907088541 -0.47488476274638008467 -0.031713579195168720148 -0.24928254101899552375 0.23102119129755410709 0.56740625259962029769 -0.23229905246441129307 0.10796070369362320562 -0.28834395632337123105 -0.038228539848942734436 -0.40286564661383422736 -0.069007659950719460462 -0.15798591126415409414 -0.26386905055113984986 -0.086839952859629032655 -0.059249593881775024229 -0.057565728174054503485 0.17711778572996372816 -0.17191378651777985964 -0.33395251379342666409 0.15838472969015160441;0.16017389326212208567 0.30921660496204755875 0.60831953334257826693 -0.40583511723569520857 0.043298807479259016073 -0.36647753670235716505 -0.22044495749948941898 -0.10798828014541024534 0.16888577618707181771 -0.42188403363105969612 0.34869728509286801454 -0.29039364985711180189 -0.28374566479141244413 -0.076451180532642437626 0.22494231615841459027 -0.35367851404283551231 -0.1528484015591613232 -0.072737422655806766025 -0.23840648792286489588 0.42828185876773666729 -0.31560987003518869987 0.29921387482502503907 -0.3191293139331556894 0.39753082766462038977 -0.36245968713917575688 -0.30861716616071521724 -0.50187024817440628599 -0.21839803216484429682 0.45000150631178226224 -0.061017303041168341471 0.30729872161364579775 -0.29132261953154581224 -0.28954652023564692032 0.087353328602688434801 -0.037278910067761808489 -0.29568127695914991904 -0.41777036315634635821 0.52912062574922136271 0.5122813853038433729 -0.11147516644652175066 -0.0036657812289096684648 -0.24008425844304784325 -0.17038677020516243554 -0.25955564463755192994;0.26945168726619073141 -0.45744627156199896278 2.1116881800671283287 0.47424421419756634943 0.048227260350739854788 -0.16690717992872794451 -0.31825444108573086588 0.20612007084751413077 -0.095938280644220511051 0.27911969992049717737 -0.070686712595277201299 -0.45871879798897269298 0.51565367564574093873 0.28104228076579729212 -0.12250169625123008554 -0.12793728755508579353 -0.27174095450559770937 0.22379094261478096883 0.10563298180771116264 -0.1539893956946730702 0.19011862683347111047 0.046288799157656351779 0.147683031477789245 -0.32319754831377184301 -0.49153086235224341394 0.092405530061374377415 -0.47885487807244297986 0.27259033766844703583 -0.69989782742299322393 0.77367610493847471798 0.066511153437171927072 -0.3454515684782977214 -0.044008085613385129753 -0.096062816408392412426 -0.03009211196711030975 0.56171510602390095634 -0.5507633728764521619 0.43036925138026221882 0.50293115829045131893 0.70573454065655483181 -0.39400356889306509256 -0.43639650231310644912 -0.61557047357755234618 -0.64183228672105097079;0.23657931802772325103 1.1916520872963924926 -0.064083106763452885035 2.2619446698280589736 0.31880696569629707326 0.36587976744261724305 -0.81286943213013440612 0.18921753326003409867 -0.54767773309228762191 -0.30536635301894626826 1.4055916045109182466 -0.37372514966142073023 1.053220318092570551 0.15882820603252242875 -0.039432312799322535857 -0.51162017706016682528 -0.15063863683652653491 -0.7073471010439120743 -0.2788855763274861177 1.000305460556077719 -0.016717838137755965111 -0.39321392165375779193 -0.44242107855295143004 -0.23772810176411057759 -0.18647841521422409139 0.068618298738437819018 -0.54961015126410561749 0.089985104824253092648 0.26976011611378353239 0.30856808384550832303 -0.45546594335212242655 0.068251823478161471881 0.12064344091596791719 0.081367615665398740354 0.041359101485465316062 0.31324334854209079371 0.24513365797906763732 -0.94008184791176807593 0.15822293605077289436 -0.21823267441459981431 0.73339147019807060524 0.59890329459168101245 1.1371434091008465472 0.65637099261453590859;-0.25289829571940825037 -1.5022136616049783786 -0.28833900766386122427 0.60479374979688838021 0.40086355307431920103 0.11029425053219796271 0.14999019340362967911 -0.29250657286823555925 0.59363401509972757442 0.09284983507266435232 -1.2774552680706534602 -0.22668821958484597356 0.83353137727873793938 0.42330263230200082525 -0.63089198487300901519 -0.21149991108431409614 -0.59073807435022795964 0.25758087643118410259 -0.035569396691805831023 -1.3528675541272860983 -0.15229143527796551449 0.010351335914942496469 -0.083302504830107024225 -0.31549780106359331944 0.48611621772255048102 -0.15116948821655640245 0.12893799347334392036 0.20225425799759444434 -1.1999509813281568071 -0.25937112168038639615 0.054047937669798443161 0.070131517955357852712 -0.53193415296805990344 -0.027360124863135753398 -0.5004206128234247597 0.53134816571884602165 -0.65645193475574492581 0.76682910223680100792 -0.055150280968971385209 0.19678354992326840822 -0.41929587847498572817 -0.64584202426857950652 -0.85304030829277655013 -0.41259755826416155688;0.041247070253865841805 0.83979305952909932831 1.5826351182402402795 2.5015814529353019857 -0.30774030660098511403 0.19657157462714763829 -0.1152404265017769186 0.20459396732826776177 0.23589384030747412302 0.36414849835851220705 -0.023870856088012287755 0.20489940910472692615 -0.59720704334597074503 0.21300195282998130031 0.05796451815155233972 0.28736828670520730977 0.2484714640377193029 0.28472384492365210296 -0.11916768424269617854 0.44167987835721933543 -0.75639378383530853078 -1.48044964491591724 0.18394720030962080637 -0.28916043070910552037 0.21740833924918451237 0.051226163068382506161 0.48834240596936023815 -0.0978507638675201602 0.83163168496125305929 -0.080458161031511432615 -0.140554738328482004 -0.73362328528617470891 -0.33586540494525723988 -0.62955710398117381565 0.28134049318021719932 -0.39778660322250142256 -0.5189627958229460214 0.34404718112368753991 -0.46604716577709814906 0.21043182390277215266 -0.49651598046234518558 -0.5658529997410475243 0.36179719136704951987 -0.4412984976873155496;0.12815266016760568091 -1.1964053066145576842 0.028528988199933602576 0.94950112092031324629 0.15384841306994873067 -0.51153239628486280033 0.25305715551813923181 -0.3683914998206238578 0.35570326329109935859 0.32406535745818165761 -0.95374211002765207912 -0.36613330457308324029 0.95789466413770885111 0.12913699919557838913 -0.53135694648668563289 0.11610658981408443491 -0.51877856244731845869 0.097764676023546742689 0.16898210720868075962 -1.7761743086356467369 -0.12681664877304421601 -0.41599680899417240676 0.73880841886346415581 0.020552542734254268531 0.40668881229782055664 -0.47753827182690100628 0.60778033379895968213 0.17602328346838505557 -0.47569391783471093316 -0.07745862276133522184 -0.23069364166891015433 -0.31811958621191444019 -0.17222222345725915482 0.15374050657491852845 0.057857748040608475426 -0.05123924554396482034 -0.7342861952055548258 0.99013701418636879126 -0.29616498778977484729 -0.79404771121585859817 -0.34602718286625383515 -0.44373927053328365844 -0.2558729739048824503 -0.66270015516304081604;-0.16928394650585434911 -0.27593616187237374193 -1.9545316261658591817 -0.51168139729537953642 0.4328442252138403612 -0.19371739118408723423 0.13855675692451649428 -0.014239325186905047588 0.1278754910644861742 -0.26502844841933337339 -0.083445377290055938735 0.074624216476072854909 -0.52342086584872937749 0.27248206470037394933 -0.29742374677252569892 0.15256368310444046177 -0.090364279289266297157 0.21701126850247318134 -0.50074489813016354045 0.41421367215915649851 -0.24224292539158431836 0.049871356892244145254 0.23570988699085440587 -0.076741652781379648962 -0.17623670256287338187 -0.16344306901089630801 0.14013634837120064747 -0.22420018018802723159 -0.026156477684184709781 -0.73096023977124302551 -0.2690079283964459389 -0.13531687841693176844 -0.065068267128088067008 -0.18252096657044866723 -0.20633813626539881936 0.11441345300611409364 0.28823531501348120809 -0.85996050419844427548 -0.091185246083271553896 -0.26507733870984701019 1.014635688070431252 0.067879748383295385183 0.72170948661777811761 0.18366133355263533633;-0.26179393213246376915 0.3819457385327600929 -0.031158392471800511886 0.11350562901876030952 0.27584894247914687471 0.2745193519093592216 -0.19434216012000099516 0.27067405143465106399 0.052889380391819881821 0.088129279155765780085 0.37258160686463015487 0.26573297470312656765 0.16633326797135028485 0.2369235487259219175 0.01318587102501398399 -0.027952894655774229021 0.038620657588533231774 0.17390248777131098179 -0.31339340038769442076 -0.20427384655864153085 0.10172347783632927631 0.36858058706256102699 -0.28271312349092608818 0.052448577689950849623 0.14173015710395919786 -0.26170721899922244624 0.27108238417210961391 0.25390445200198202835 -0.043117763467041748948 -0.029153388033521444866 0.05739874365835836989 -0.29063160912920127377 0.05784392401175873083 0.035592231614638446258 0.26190619258888991894 0.28837438705337509193 -0.06338187988499476011 -0.12133400722408008154 0.023635632300761506147 0.39743455785779419065 0.018633038484573170857 -0.32092381055946095358 0.1020213643817987903 0.05320898671303313926];

% Layer 2
b2 = [-0.14392452562587984555;0.23985814064293467518;-0.25855583885214178386;-0.55891779325506563136;-0.83581258397444369024;-0.22409936171166675023];
LW2_1 = [0.40085248330486433765 -0.0188517572131352458 0.85147984578750057771 1.0015093351553936429 -1.4685922784912883721 2.0566990433441190156 2.1087362922164603063 2.5997659818772240747 -1.0592692462605535209 1.327005360627606656;0.72985238701110466408 -1.1839995960322835522 -1.9480004252686013988 -0.9614789595319641613 1.8331648593055558383 1.5029268613503927732 -0.65848344866781416407 1.0614430343043494975 2.1839239124029781181 -0.87596009723793810675;0.52369594630937199575 1.6128943099675556727 -0.21005911027125015456 -0.89345105923338363763 -3.1061696445178679227 -0.84586003908414475472 -0.46151145401088344844 -1.4334702438133590796 0.087797647542727633163 -1.0891088011943645952;0.21599160056625854587 0.46751208116244402646 -0.8452769504837713832 -1.7269605746015022074 2.2563534338792154976 -4.0233998117467608679 2.6938574539070585523 -1.6964422461156642985 0.061303665778847812873 -0.0073720886403538139764;0.51373569081767178623 1.0609163557546457124 1.4456321312288420433 0.68510017555692936941 -0.92503751185856253336 2.1605232910707905525 -3.1856903679856252154 2.0723181193601085681 -0.38828559761033348829 0.083457271569432070479;1.0749219290261227133 1.0820710476414263645 -0.38042665890726984346 1.834875608233241584 0.34763691701131566036 -0.696489693023046752 1.5106512401262821577 -1.3465042594725769032 -1.7592803419064271253 0.3633157598028401436];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
y1 = y1';
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
y = x(settings.keep,:);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
